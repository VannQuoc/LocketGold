<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Locket Gold Installer - Premium Unlock</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* --- 1. GLOBAL VARIABLES & RESET --- */
        :root {
            --primary: #fbbf24;
            --primary-dark: #d97706;
            --bg-dark: #0f172a;
            --bg-gradient: linear-gradient(135deg, #0f172a 0%, #312e81 100%);
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --glass-blur: blur(20px);
            --text-main: #ffffff;
            --text-sub: #94a3b8;
            --danger: #ef4444;
            --success: #10b981;
            --radius-md: 16px;
            --radius-lg: 24px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Be Vietnam Pro', sans-serif; }
        
        body {
            background: var(--bg-gradient);
            color: var(--text-main);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            padding: 20px;
            overflow-x: hidden;
        }

        /* --- 2. LAYOUT COMPONENTS --- */
        .app-container {
            width: 100%;
            max-width: 600px;
            background: var(--glass-bg);
            backdrop-filter: var(--glass-blur);
            -webkit-backdrop-filter: var(--glass-blur);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            padding: 30px;
            margin-top: 20px;
            margin-bottom: 80px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            animation: slideUp 0.6s cubic-bezier(0.2, 0.8, 0.2, 1);
            position: relative;
        }

        header { text-align: center; margin-bottom: 35px; }
        .logo-icon { font-size: 3.5rem; color: var(--primary); margin-bottom: 10px; filter: drop-shadow(0 0 15px rgba(251,191,36,0.4)); }
        .app-title { font-size: 1.8rem; font-weight: 800; background: linear-gradient(to right, #fff, var(--primary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 5px; }
        .app-desc { color: var(--text-sub); font-size: 0.95rem; }

        /* --- 3. PLATFORM SELECTOR --- */
        .platform-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .platform-card {
            background: rgba(255,255,255,0.03);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-md);
            padding: 25px 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .platform-card:hover { background: rgba(255,255,255,0.1); transform: translateY(-5px); border-color: var(--primary); }
        .platform-card i { font-size: 2.5rem; margin-bottom: 12px; display: block; }
        .platform-card.ios i { color: #fff; }
        .platform-card.android i { color: #3ddc84; }
        .platform-label { font-weight: 600; font-size: 1.1rem; }

        /* --- 4. ACCORDION (THU GỌN) STYLES --- */
        .accordion-box {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            margin-bottom: 20px;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .accordion-header {
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            font-weight: 600;
            background: rgba(255,255,255,0.02);
            color: var(--text-sub);
        }
        .accordion-header:hover { background: rgba(255,255,255,0.05); color: #fff; }
        .accordion-header i { transition: transform 0.3s ease; }
        
        /* Khi accordion mở */
        .accordion-box.active .accordion-header {
            color: var(--primary);
            border-bottom: 1px solid var(--glass-border);
        }
        .accordion-box.active .accordion-header i { transform: rotate(180deg); }
        
        .accordion-content {
            display: none; /* Mặc định ẩn */
            padding: 15px;
            animation: fadeIn 0.3s ease;
        }
        .accordion-box.active .accordion-content { display: block; }

        /* Support Box Specifics */
        .support-header-text { display: flex; align-items: center; gap: 10px; }
        .social-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 5px; }
        .btn-social {
            padding: 10px; border-radius: 8px; text-decoration: none; font-weight: 600; font-size: 0.85rem;
            display: flex; align-items: center; justify-content: center; gap: 8px; transition: 0.2s;
        }
        .btn-fb { background: #1877f2; color: #fff; }
        .btn-fb:hover { background: #155db5; }
        .btn-insta { background: linear-gradient(45deg, #f09433 0%,#e6683c 25%,#dc2743 50%,#cc2366 75%,#bc1888 100%); color: #fff; }
        .btn-insta:hover { opacity: 0.9; }

        /* --- 5. CONTENT SECTIONS --- */
        .view-section { display: none; animation: fadeIn 0.4s ease-out; }
        
        .step-item {
            background: rgba(0,0,0,0.2);
            border-radius: var(--radius-md);
            padding: 20px;
            margin-bottom: 25px;
            border-left: 4px solid var(--primary);
        }
        
        .step-header { display: flex; align-items: center; gap: 12px; margin-bottom: 15px; }
        .step-badge { background: var(--primary); color: #000; width: 28px; height: 28px; border-radius: 50%; display: grid; place-items: center; font-weight: 800; font-size: 0.9rem; }
        .step-title { font-weight: 700; color: var(--primary); font-size: 1.1rem; }
        .step-desc { color: var(--text-sub); line-height: 1.6; font-size: 0.95rem; margin-bottom: 15px; }
        .step-desc strong { color: #fff; }

        /* Media Placeholder */
        .media-placeholder {
            width: 100%; height: auto;
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            border: 1px dashed var(--glass-border);
            display: flex;
            flex-direction: column;
            justify-content: center; align-items: center;
            color: var(--text-sub);
            margin: 15px 0; overflow: hidden; position: relative;
        }
        .media-placeholder img { width: 100%; height: 100%; object-fit: cover; }

        /* Buttons */
        .btn {
            width: 100%; padding: 14px; border-radius: 12px; border: none; cursor: pointer;
            font-weight: 700; font-size: 1rem; display: flex; justify-content: center; align-items: center; gap: 8px;
            text-decoration: none; transition: transform 0.2s, box-shadow 0.2s;
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
        .btn-primary { background: linear-gradient(90deg, var(--primary), var(--primary-dark)); color: #000; }
        .btn-success { background: linear-gradient(90deg, #10b981, #059669); color: white; }
        .btn-purple { background: linear-gradient(90deg, #8b5cf6, #6d28d9); color: white; }
        .btn-outline { background: transparent; border: 1px solid var(--glass-border); color: var(--text-sub); width: auto; padding: 8px 16px; margin-bottom: 20px; font-size: 0.9rem; }
        .btn-outline:hover { background: rgba(255,255,255,0.05); color: #fff; }
        .btn-loadmore { background: rgba(255,255,255,0.08); color: #fff; margin-top: 15px; border: 1px dashed var(--glass-border); }

        /* Account Cards */
        .id-card {
            background: rgba(255,255,255,0.04); border: 1px solid var(--glass-border);
            border-radius: 12px; padding: 15px; margin-bottom: 15px; animation: fadeIn 0.5s;
        }
        .id-header { display: flex; justify-content: space-between; font-size: 0.8rem; margin-bottom: 10px; color: var(--text-sub); }
        .status-dot { width: 8px; height: 8px; background: var(--success); border-radius: 50%; display: inline-block; margin-right: 5px; }
        .status-offline { background: var(--danger); }
        
        .copy-box {
            display: flex; background: rgba(0,0,0,0.3); border: 1px solid var(--glass-border);
            border-radius: 8px; margin-bottom: 8px; overflow: hidden;
        }
        .copy-icon { width: 40px; display: flex; align-items: center; justify-content: center; color: var(--text-sub); background: rgba(255,255,255,0.02); border-right: 1px solid var(--glass-border); }
        .copy-content { flex: 1; padding: 10px; font-family: 'Monaco', monospace; font-size: 0.9rem; color: #fff; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .copy-action { background: transparent; border: none; color: var(--primary); width: 45px; cursor: pointer; border-left: 1px solid var(--glass-border); transition: 0.2s; }
        .copy-action:hover { background: var(--primary); color: #000; }

        /* Floating Donate */
        .donate-btn {
            position: fixed; bottom: 25px; right: 25px;
            background: linear-gradient(135deg, #ec4899, #8b5cf6);
            color: #fff; padding: 12px 24px; border-radius: 50px;
            font-weight: 700; cursor: pointer; box-shadow: 0 5px 20px rgba(236, 72, 153, 0.4);
            display: flex; align-items: center; gap: 8px; z-index: 100; transition: 0.3s;
        }
        .donate-btn:hover { transform: translateY(-5px) scale(1.05); }

        /* Modals */
        .modal {
            position: fixed; inset: 0; background: rgba(0,0,0,0.85); backdrop-filter: blur(8px);
            z-index: 999; display: none; justify-content: center; align-items: center; padding: 20px;
        }
        .modal.active { display: flex; }
        .modal-box {
            background: #1e293b; width: 100%; max-width: 420px; padding: 30px; border-radius: 24px;
            text-align: center; border: 1px solid var(--glass-border); position: relative;
            animation: slideUp 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .modal-icon { font-size: 3rem; margin-bottom: 15px; }
        .modal h3 { font-size: 1.4rem; color: #fff; margin-bottom: 10px; }
        .modal-list { text-align: left; margin: 15px 0 25px 0; color: var(--text-sub); list-style: none; }
        .modal-list li { margin-bottom: 10px; display: flex; gap: 10px; }
        .modal-list li i { color: var(--primary); margin-top: 4px; }
        
        .modal-media { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin: 12px 0; }
        .modal-media img { width: 100%; border-radius: 6px; object-fit: cover; }
        .qr-area { background: #fff; padding: 10px; border-radius: 12px; margin: 20px auto; width: 200px; height: 200px; display: flex; align-items: center; justify-content: center; }
        .qr-area img { width: 100%; height: 100%; object-fit: contain; }

        #toast {
            position: fixed; bottom: 90px; left: 50%; transform: translateX(-50%);
            background: #334155; color: #fff; padding: 12px 24px; border-radius: 50px;
            font-weight: 500; opacity: 0; visibility: hidden; transition: 0.3s;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3); border: 1px solid var(--glass-border); z-index: 1000;
        }
        #toast.show { opacity: 1; visibility: visible; bottom: 100px; }
        
        .spinner { width: 30px; height: 30px; border: 3px solid rgba(255,255,255,0.1); border-top-color: var(--primary); border-radius: 50%; animation: spin 0.8s linear infinite; margin: 20px auto; }
        @keyframes spin { to { transform: rotate(360deg); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

    </style>
</head>
<body>

    <div class="app-container">
        <header>
            <div class="logo-icon"><i class="fa-solid fa-bolt"></i></div>
            <h1 class="app-title">VannQuocIsMe-Locket Gold Installer</h1>
            <p class="app-desc">Locket Gold By VannQuocIsMe</p>
        </header>

        <div id="view-home" class="platform-grid">
            <div class="platform-card ios" onclick="nav.to('ios')">
                <i class="fab fa-apple"></i>
                <div class="platform-label">iPhone / iPad (iOS)</div>
            </div>
            <div class="platform-card android" onclick="nav.to('android')">
                <i class="fab fa-android"></i>
                <div class="platform-label">Android</div>
            </div>
        </div>

        <section id="view-android" class="view-section">
            <button class="btn btn-outline" onclick="nav.home()"><i class="fa-solid fa-arrow-left"></i> Quay lại</button>
            
            <div class="accordion-box">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <div class="support-header-text"><i class="fa-solid fa-headset"></i> Cần hỗ trợ cài đặt?</div>
                    <i class="fa-solid fa-chevron-down"></i>
                </div>
                <div class="accordion-content">
                    <div style="font-size: 0.9rem; margin-bottom: 10px; color: var(--text-sub);">
                        Liên hệ mình qua các kênh sau để được support nhanh nhất:
                    </div>
                    <div class="social-grid">
                        <a id="link-fb-android" href="#" target="_blank" class="btn-social btn-fb">
                            <i class="fa-brands fa-facebook-f"></i> Facebook
                        </a>
                        <a id="link-insta-android" href="#" target="_blank" class="btn-social btn-insta">
                            <i class="fa-brands fa-instagram"></i> Instagram
                        </a>
                    </div>
                </div>
            </div>

            <div class="step-item">
                <div class="step-header">
                    <div class="step-badge">1</div>
                    <div class="step-title">Tải File APK</div>
                </div>
                <div class="step-desc">Tải file cài đặt đã được mở khóa tính năng Locket Gold sẵn.</div>
                <a href="https://drive.google.com/file/d/1bsEiGTNOdbVcpgXPZ9JUOPwQUmbCX0QE/view?usp=drive_link" class="btn btn-primary"><i class="fa-solid fa-download"></i> Tải APK Ngay</a>
            </div>

            <div class="step-item">
                <div class="step-header">
                    <div class="step-badge">2</div>
                    <div class="step-title">Hướng dẫn cài đặt</div>
                </div>
                
                <div class="accordion-box" style="background: rgba(0,0,0,0.3); border:none; margin-bottom: 0;">
                    <div class="accordion-header" onclick="toggleAccordion(this)" style="padding: 10px; border-radius: 8px;">
                        <span>Xem chi tiết hướng dẫn</span>
                        <i class="fa-solid fa-chevron-down"></i>
                    </div>
                    <div class="accordion-content">
                        <div class="step-desc">Mở file vừa tải và chọn "Cài đặt". Nếu máy hỏi quyền, hãy chọn <strong>Cho phép từ nguồn này</strong>.</div>
                        <div class="media-placeholder">
                            <img src="https://hoanghamobile.com/tin-tuc/wp-content/webp-express/webp-images/uploads/2023/11/app-apk-7.jpg.webp">
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="view-ios" class="view-section">
            <button class="btn btn-outline" onclick="nav.home()"><i class="fa-solid fa-arrow-left"></i> Quay lại</button>

            <div class="accordion-box">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <div class="support-header-text"><i class="fa-solid fa-headset"></i> Cần hỗ trợ cài đặt?</div>
                    <i class="fa-solid fa-chevron-down"></i>
                </div>
                <div class="accordion-content">
                    <div style="font-size: 0.9rem; margin-bottom: 10px; color: var(--text-sub);">
                        Liên hệ mình qua các kênh sau để được support nhanh nhất:
                    </div>
                    <div class="social-grid">
                        <a id="link-fb-ios" href="#" target="_blank" class="btn-social btn-fb">
                            <i class="fa-brands fa-facebook-f"></i> Facebook
                        </a>
                        <a id="link-insta-ios" href="#" target="_blank" class="btn-social btn-insta">
                            <i class="fa-brands fa-instagram"></i> Instagram
                        </a>
                    </div>
                </div>
            </div>

            <div class="step-item">
                <div class="step-header">
                    <div class="step-badge">1</div>
                    <div class="step-title">Cài đặt Shadowrocket & ID Apple</div>
                </div>
                
                <div class="accordion-box" style="margin-bottom: 20px;">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <div style="font-weight: bold; color: var(--success);"><i class="fa-solid fa-bolt"></i> Cách 1: Cài Nhanh (OTA)</div>
                        <i class="fa-solid fa-chevron-down"></i>
                    </div>
                    <div class="accordion-content">
                        <div class="step-desc" style="font-size: 0.9rem;">Thử cài Shadowrocket trực tiếp không cần ID Apple.</div>
                        <a href="itms-services://?action=download-manifest&url=https://github.com/VannQuoc/LocketDowngrade/raw/main/shadowrocket/manifest.plist" class="btn btn-purple" style="margin-bottom: 10px;">
                            <i class="fa-solid fa-rocket"></i> Cài Shadowrocket
                        </a>
                        <div style="font-size: 0.8rem; color: #fca5a5; font-style: italic;">
                            *Lưu ý: Có thể không tương thích với một số máy. Nếu lỗi, hãy dùng Cách 2 bên dưới.
                        </div>
                    </div>
                </div>

                <div style="border-top: 1px solid var(--glass-border); padding-top: 20px;">
                    <div style="font-weight: bold; color: var(--primary); margin-bottom: 5px;"><i class="fa-brands fa-apple"></i> Cách 2: Dùng ID Apple chung</div>
                    <div class="step-desc">
                        Sử dụng tài khoản dưới đây để tải từ <strong>App Store</strong> (Tuyệt đối KHÔNG đăng nhập iCloud trong Cài đặt).
                    </div>

                    <div id="id-area" style="display:none;">
                        <div id="loading-spinner" class="spinner"></div>
                        <div id="id-list"></div>
                        <button id="btn-loadmore" class="btn btn-loadmore" onclick="dataManager.loadMore()">
                            Xem thêm tài khoản <i class="fa-solid fa-chevron-down"></i>
                        </button>
                    </div>

                    <button id="btn-fetch" class="btn btn-primary" onclick="ui.openModal('warning-modal')">
                        <i class="fa-solid fa-key"></i> Lấy Danh Sách ID
                    </button>
                </div>
            </div>

            <div class="step-item">
                <div class="step-header">
                    <div class="step-badge">2</div>
                    <div class="step-title">Đăng Nhập Vào AppStore</div>
                </div>
                
                <div class="accordion-box" style="background: rgba(0,0,0,0.3); border:none; margin-bottom: 0;">
                    <div class="accordion-header" onclick="toggleAccordion(this)" style="padding: 10px; border-radius: 8px;">
                        <span>Xem chi tiết các bước </span>
                        <i class="fa-solid fa-chevron-down"></i>
                    </div>
                    <div class="accordion-content">
                        <div class="step-desc">Vào Appsore, chọn vào phần <strong>Tài Khoản</strong> (Góc Trên Bên Phải)</div>
                        <div class="media-placeholder"><img src="https://i.ibb.co/nMv5sksY/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-1.png"></div>
                        
                        <div class="step-desc">Kéo xuống dưới cùng, chọn <strong>Đăng Xuất</strong></div>
                        <div class="media-placeholder"><img src="https://i.ibb.co/ht51xBc/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-2.png"></div>
                        <div class="media-placeholder"><img src="https://i.ibb.co/xtBgj5QJ/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-3.png"></div>
                        
                        <div class="step-desc">Sau đó kéo lại lên trên cùng và đăng nhập tài khoản bạn vừa lấy.</div>
                        <div class="step-desc">Lưu Ý: Một số máy sẽ hiện ra thông báo như hình dưới, bạn chỉ cần chọn dòng không phải (như trên hình) là được.</div>
                        <div class="media-placeholder"><img src="https://i.ibb.co/7J4WbZ3k/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-6.png"></div>
                        
                        <div class="step-desc">Bấm vào mục ứng dụng (có thể hiển thị ngôn ngữ khác nhưng vị trí thì tương tự ảnh gốc).</div>
                        <div class="media-placeholder"><img src="https://i.ibb.co/k65SYDs5/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-7.png"></div>
                        
                        <div class="step-desc">Tìm ứng dụng <strong>Shadowrocket</strong></div>
                        <div class="media-placeholder"><img src="https://i.ibb.co/4ZNyd4mj/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-9.png"></div>
                        <div class="step-desc"><strong>Lưu Ý</strong>: Một số Id Apple sẽ bị lỗi không tải được hoặc không có app, bạn vui lòng đổi lại id khác phía trên nhé.</div>
                    </div>
                </div>
            </div>

            <div class="step-item">
                <div class="step-header">
                    <div class="step-badge">3</div>
                    <div class="step-title">Cấu hình Shadowrocket</div>
                </div>

                <div class="accordion-box" style="background: rgba(0,0,0,0.3); border:none; margin-bottom: 0;">
                    <div class="accordion-header" onclick="toggleAccordion(this)" style="padding: 10px; border-radius: 8px;">
                        <span>Xem chi tiết cấu hình</span>
                        <i class="fa-solid fa-chevron-down"></i>
                    </div>
                    <div class="accordion-content">
                        <div class="step-desc">Sau khi đã tải thành công, bạn hãy vào app <strong>Shadowrocket</strong></div>
                        <div class="media-placeholder"><img src="https://i.ibb.co/zWHwS7DK/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-12.png"></div>
                        
                        <div class="step-desc">Chọn vào mục <strong>Cấu Hình</strong> -> Chọn dấu <strong>+</strong> góc trên bên phải.</div>
                        <div class="media-placeholder"><img src="https://i.ibb.co/wF7xpHz6/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-13.png"></div>
                        <div class="media-placeholder"><img src="https://i.ibb.co/Gfbw6T1N/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-14.png"></div>
                        
                        <div class="step-desc">
                            Copy link sau và dán vào: <strong style="cursor:pointer; color: var(--primary); text-decoration: underline;" onclick="ui.copy('https://raw.githubusercontent.com/vuong2023/shad/main/modules/Locket_ohb.sgmodule')">Nhấn vào đây để copy link</strong>
                        </div>
                        <div class="media-placeholder"><img src="https://i.ibb.co/DPx7hvj6/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-15.png"></div>
                        
                        <div class="step-desc">Chọn vào chữ <strong>i</strong> của <strong>Locket_obh.conf</strong> -> Chọn mục <strong>Giải mã HTTPS</strong> -> Bật lên.</div>
                        <div class="media-placeholder"><img src="https://i.ibb.co/1t56qPZX/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-16.png"></div>
                        <div class="media-placeholder"><img src="https://i.ibb.co/Kpf4CCsL/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-17.png"></div>
                        <div class="media-placeholder"><img src="https://i.ibb.co/YThCq8qB/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-18.png"></div>
                        
                        <div class="step-desc">Tạo chứng chỉ CA mới -> Cài đặt chứng chỉ CA và hệ thống.</div>
                        <div class="media-placeholder"><img src="https://i.ibb.co/nN7gy68C/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-19.png"></div>
                        <div class="media-placeholder"><img src="https://i.ibb.co/8ChCvxj/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-20.png"></div>
                        <div class="media-placeholder"><img src="https://i.ibb.co/ZR9FMJ53/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-21.png"></div>
                        <div class="media-placeholder"><img src="https://i.ibb.co/MyRfrXBr/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-22.png"></div>
                        
                        <div class="step-desc">Vào <strong>Cài đặt máy</strong> -> <strong>Cài đặt chung</strong> -> <strong>Quản lý VPN & Thiết Bị</strong> -> Chọn <strong>Shadowrocket</strong> -> Cài đặt.</div>
                        <div class="media-placeholder"><img src="https://i.ibb.co/v6xkfSsZ/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-24.png"></div>
                        <div class="media-placeholder"><img src="https://i.ibb.co/S4RJzb6w/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-25.png"></div>
						<div class="media-placeholder"><img src="https://i.ibb.co/zhsgFxxk/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-26.png"></div>
						<div class="media-placeholder"><img src="https://i.ibb.co/qFs7vpJF/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-27.png"></div>
                        
                        <div class="step-desc">Quay lại <strong>Cài đặt chung</strong> -> <strong>Giới thiệu</strong> -> <strong>Cài đặt tin cậy chứng nhận</strong> -> Bật Shadowrocket lên.</div>
                        <div class="media-placeholder"><img src="https://i.ibb.co/pBqMvkwM/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-28.png"></div>
						<div class="media-placeholder"><img src="https://i.ibb.co/qYdn1vCX/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-29.png"></div>
						<div class="step-desc">Bật Shadowrocket Lên (Tốt nhất là bật hết tất cả mọi cái như trong hình )</div>
						<div class="media-placeholder"><img src="https://i.ibb.co/FbWLmDsp/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-30.png"></div>
						<div class="step-desc">Quay lại <strong>Shadowrocket</strong></div>
						<div class="media-placeholder"><img src="https://i.ibb.co/2334y1zR/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-31.png"></div>
						<div class="media-placeholder"><img src="https://i.ibb.co/HD7PHWXr/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-32.png"></div>
						<div class="media-placeholder"><img src="https://i.ibb.co/KcTV3KL8/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-33.png"></div>
						<div class="media-placeholder"><img src="https://i.ibb.co/ds9Nmn6z/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-34.png"></div>
						<div class="media-placeholder"><img src="https://i.ibb.co/fVn67PNH/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-35.png"></div>
						<div class="media-placeholder"><img src="https://i.ibb.co/xKhPRgZM/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-36.png"></div>
						<div class="media-placeholder"><img src="https://i.ibb.co/NdsCW65q/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-37.png"></div>
						<div class="media-placeholder"><img src="https://i.ibb.co/4nhkVVP5/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-38.png"></div>
						<div class="step-desc">Sau khi làm xong các bước trên, bạn quay lại Locket, nếu vẫn chưa hiện Gold thì thoát Locket vào lại</div>
                    </div>
                </div>
            </div>

            <div class="step-item">
                <div class="step-header">
                    <div class="step-badge">4</div>
                    <div class="step-title">Hạ cấp Locket</div>
                </div>
                <div class="step-desc">Sau khi bật VPN Shadowrocket, bạn đã có thể dùng Gold, tuy nhiên để tránh việc bạn luôn phải bật Shadowrocket thì bạn có thể cài bản Locket hạ cấp</div>
				<div style="font-size: 0.8rem; color: #fca5a5; font-style: italic;">*Lưu ý: Contact với mình để được hướng dẫn hạ cấp Locket (có phí), nếu bạn không có nhu cầu có thể bỏ qua bước này vẫn sẽ dùng Locket một cách bình thường, khi cài bạn sẽ được tặng kèm thêm app Rổ Phim free nhé!</div>
                <a id="link-ota" href="#" class="btn btn-success">
                    <i class="fa-solid fa-cloud-arrow-down"></i> Cài Đặt Locket
                </a>
                <a href="itms-services://?action=download-manifest&url=https://github.com/VannQuoc/LocketDowngrade/raw/main/rophim/manifest.plist" class="btn btn-purple" style="margin-bottom: 10px;">
                    <i class="fa-solid fa-rocket"></i> Cài Đặt Rổ Phim
                </a>
            </div>
        </section>
    </div>

    <div class="donate-btn" onclick="ui.openModal('donate-modal')">
        <i class="fa-solid fa-heart"></i> <span>Donate</span>
    </div>

    <div id="warning-modal" class="modal">
        <div class="modal-box">
            <div class="modal-icon" style="color: var(--danger);"><i class="fa-solid fa-triangle-exclamation"></i></div>
            <h3>CẢNH BÁO QUAN TRỌNG</h3>
            <div class="modal-media">
                <img src="https://i.ibb.co/m5KNtrjh/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-39.png">
                <img src="https://i.ibb.co/b5cH5J5m/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-10.png">
                <img src="https://i.ibb.co/gbBp1TLm/N-i-dung-o-n-v-n-b-n-c-a-b-n-zip-11.png">
            </div>
            <ul class="modal-list">
                <li><i class="fa-solid fa-check"></i> Chỉ đăng nhập trong <strong>App Store</strong>.</li>
                <li><i class="fa-solid fa-xmark" style="color:var(--danger)"></i> KHÔNG đăng nhập iCloud trong Cài đặt.</li>
                <li><i class="fa-solid fa-shield"></i> Nếu hỏi nâng cấp bảo mật → Chọn "Các Lựa Chọn Khác" → "Không Nâng Cấp".</li>
            </ul>
            <button class="btn btn-primary" onclick="dataManager.fetchIDs()">Tôi đồng ý</button>
            <button class="btn btn-outline" style="margin-top:10px; width:100%; border:none;" onclick="ui.closeModal('warning-modal')">Huỷ bỏ</button>
        </div>
    </div>

    <div id="donate-modal" class="modal">
        <div class="modal-box" style="background: #fff; color: #333;">
            <h3 style="color:#000;">Cảm ơn bạn đã ủng hộ ❤️</h3>
            <p style="color:#666; font-size: 0.9rem;">Sự ủng hộ của bạn giúp mình duy trì Server.</p>
            <div class="qr-area">
                <img src="https://img.vietqr.io/image/mbbank-012345672110-compact.jpg?addInfo=donate%20locket%20gold&accountName=Le%20Van%20Quoc" alt="QR Code">
            </div>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
                <a href="https://page.momoapp.vn/YKuKJj4cVlc" class="btn" style="background:#d946ef; color:#fff; font-size:0.8rem;">Momo</a>
            </div>
            <button class="btn btn-outline" style="margin-top:15px; width:100%; color:#555; border-color:#ddd;" onclick="ui.closeModal('donate-modal')">Đóng</button>
        </div>
    </div>

    <div id="toast"><i class="fa-solid fa-check-circle"></i> Đã sao chép vào bộ nhớ tạm!</div>

    <script>
        // CONFIG
        const CONFIG = {
            workerUrl: 'https://locket.levanquocht21.workers.dev/', 
            otaUrl: 'itms-services://?action=download-manifest&url=https://github.com/VannQuoc/LocketDowngrade/raw/main/manifest.plist',
            itemsPerBatch: 3
        };
        document.getElementById('link-ota').href = CONFIG.otaUrl;

        // UI MANAGER
        const ui = {
            toastTimeout: null,
            openModal: (id) => document.getElementById(id).classList.add('active'),
            closeModal: (id) => document.getElementById(id).classList.remove('active'),
            showToast: (msg) => {
                const t = document.getElementById('toast');
                t.innerHTML = `<i class="fa-solid fa-check-circle"></i> ${msg}`;
                t.classList.add('show');
                clearTimeout(ui.toastTimeout);
                ui.toastTimeout = setTimeout(() => t.classList.remove('show'), 3000);
            },
            copy: (text) => {
                if (!text || text === "...") return;
                navigator.clipboard.writeText(text).then(() => ui.showToast(`Đã chép: ${text}`))
                .catch(() => alert("Lỗi copy"));
            }
        };

        // NAV MANAGER
        const nav = {
            to: (view) => {
                document.getElementById('view-home').style.display = 'none';
                document.querySelectorAll('.view-section').forEach(el => el.style.display = 'none');
                document.getElementById('view-' + view).style.display = 'block';
                window.scrollTo(0, 0);
                
                // KHI CHUYỂN TRANG -> CHECK DEVICE ĐỂ UPDATE LINK
                checkDeviceAndSetLinks();
            },
            home: () => {
                document.querySelectorAll('.view-section').forEach(el => el.style.display = 'none');
                document.getElementById('view-home').style.display = 'grid';
            }
        };

        // ACCORDION LOGIC
        function toggleAccordion(element) {
            const parent = element.parentElement;
            parent.classList.toggle('active');
        }

        // DEVICE DETECTION LOGIC (MOBILE VS PC)
        function checkDeviceAndSetLinks() {
            // Regex check user agent mobile
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            
            // Cấu hình link
            const links = {
                fb: {
                    mobile: 'fb://profile/100071063622302',
                    web: 'https://www.facebook.com/profile.php?id=100071063622302'
                },
                insta: {
                    mobile: 'instagram://user?username=vannquoc.21',
                    web: 'https://www.instagram.com/vannquoc.21/'
                }
            };

            // Hàm set link cho thẻ a
            const setLink = (id, type) => {
                const el = document.getElementById(id);
                if(el) {
                    el.href = isMobile ? links[type].mobile : links[type].web;
                    // Nếu là web thì mở tab mới, deeplink thì không cần
                    if(!isMobile) el.setAttribute('target', '_blank');
                    else el.removeAttribute('target');
                }
            };

            // Set cho cả Android và iOS view
            setLink('link-fb-android', 'fb');
            setLink('link-insta-android', 'insta');
            setLink('link-fb-ios', 'fb');
            setLink('link-insta-ios', 'insta');
            
            // Log để kiểm tra (có thể xóa)
            console.log("Device detected:", isMobile ? "Mobile" : "PC/Desktop");
        }

        // FETCH DATA MANAGER
        const dataManager = {
            allAccounts: [],
            currentShown: 0,

            fetchIDs: async () => {
                ui.closeModal('warning-modal');
                const els = {
                    btn: document.getElementById('btn-fetch'),
                    area: document.getElementById('id-area'),
                    loader: document.getElementById('loading-spinner'),
                    list: document.getElementById('id-list'),
                    error: (msg) => els.list.innerHTML = `<div style="color:var(--danger); text-align:center;">${msg}</div>`
                };

                if (!CONFIG.workerUrl) return;

                els.btn.style.display = 'none';
                els.area.style.display = 'block';
                els.loader.style.display = 'block';
                els.list.innerHTML = '';

                try {
                    const res = await fetch(CONFIG.workerUrl);
                    if (!res.ok) throw new Error("Worker Error");
                    const html = await res.text();
                    dataManager.parseData(html);
                } catch (e) {
                    els.error(`Lỗi kết nối: ${e.message}`);
                } finally {
                    els.loader.style.display = 'none';
                }
            },

            parseData: (html) => {
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                const cards = doc.querySelectorAll('main div.bg-white.rounded-2xl');
                dataManager.allAccounts = [];

                cards.forEach((card, i) => {
                    let username = "...";
                    const uSpan = card.querySelector(`span[id^="user_"]`);
                    if (uSpan) {
                        const cf = uSpan.querySelector('.__cf_email__');
                        username = cf ? dataManager.decodeCF(cf.getAttribute('data-cfemail')) : uSpan.innerText.trim();
                    }

                    let password = "Xem ở web gốc";
                    const pSpan = card.querySelector(`span[id*="pass"]`);
                    if(pSpan) password = pSpan.innerText.trim();
                    else {
                        const spans = card.querySelectorAll('span');
                        spans.forEach(s => {
                            if(!s.id.includes('user') && s.innerText.length > 5) password = s.innerText.trim();
                        });
                    }
                    const isLive = card.innerText.includes("Hoạt động");
                    dataManager.allAccounts.push({ index: i+1, username, password, isLive });
                });

                if (dataManager.allAccounts.length === 0) {
                    document.getElementById('id-list').innerHTML = "Không tìm thấy dữ liệu.";
                    return;
                }
                dataManager.currentShown = 0;
                document.getElementById('id-list').innerHTML = '';
                dataManager.loadMore();
            },

            loadMore: () => {
                const container = document.getElementById('id-list');
                const batch = dataManager.allAccounts.slice(dataManager.currentShown, dataManager.currentShown + CONFIG.itemsPerBatch);
                
                batch.forEach(acc => {
                    const statusClass = acc.isLive ? '' : 'status-offline';
                    const statusText = acc.isLive ? 'Hoạt động' : 'Bảo trì';
                    const html = `
                        <div class="id-card">
                            <div class="id-header">
                                <span>Account #${acc.index}</span>
                                <div><span class="status-dot ${statusClass}"></span>${statusText}</div>
                            </div>
                            <div class="copy-box">
                                <div class="copy-icon"><i class="fa-solid fa-user"></i></div>
                                <div class="copy-content">${acc.username}</div>
                                <button class="copy-action" onclick="ui.copy('${acc.username}')"><i class="fa-regular fa-copy"></i></button>
                            </div>
                            <div class="copy-box" style="margin-bottom:0">
                                <div class="copy-icon"><i class="fa-solid fa-key"></i></div>
                                <div class="copy-content">${acc.password}</div>
                                <button class="copy-action" onclick="ui.copy('${acc.password}')"><i class="fa-regular fa-copy"></i></button>
                            </div>
                        </div>
                    `;
                    container.insertAdjacentHTML('beforeend', html);
                });

                dataManager.currentShown += batch.length;
                const btn = document.getElementById('btn-loadmore');
                btn.style.display = (dataManager.currentShown >= dataManager.allAccounts.length) ? 'none' : 'block';
            },

            decodeCF: (str) => {
                let e = "", r = parseInt(str.substr(0, 2), 16);
                for (let n = 2; n < str.length; n += 2) {
                    let c = parseInt(str.substr(n, 2), 16) ^ r;
                    e += String.fromCharCode(c);
                }
                return e;
            }
        };

        // Chạy check lần đầu
        checkDeviceAndSetLinks();
    </script>
</body>
</html>
